<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${title} + ' - Zeferini'">Zeferini</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300..700">
    <link rel="stylesheet" th:href="@{/css/styles.css}">
</head>
<body>
    <div class="app-shell">
        <!-- Navbar -->
        <nav class="app-shell__navbar">
            <div class="navbar-content">
                <button class="navbar-burger" onclick="toggleDrawer()" title="Menu">
                    <span class="material-symbols-rounded">menu</span>
                </button>
                <div class="navbar-title">Zeferini</div>
                <div class="navbar-spacer"></div>
            </div>
        </nav>

        <!-- Sidenav Drawer -->
        <nav class="app-shell__drawer" id="drawer">
            <div class="sidenav-header">
                <h2>Zeferini</h2>
                <button class="sidenav-close" onclick="closeDrawer()" title="Fechar menu">
                    <span class="material-symbols-rounded">close</span>
                </button>
            </div>

            <div class="sidenav-content">
                <!-- Principal Section -->
                <div class="sidenav-section">
                    <h3 class="sidenav-section-title">Principal</h3>
                    <a href="#" class="sidenav-item" th:href="@{/persons}" onclick="closeDrawer()">
                        <span class="material-symbols-rounded">people</span>
                        <span>Pessoas</span>
                    </a>
                </div>

                <!-- APIs Section -->
                <div class="sidenav-section">
                    <h3 class="sidenav-section-title">APIs</h3>
                    <a href="http://localhost:8084/" target="_blank" rel="noopener noreferrer" class="sidenav-item">
                        <span class="material-symbols-rounded">hub</span>
                        <span>API Gateway</span>
                        <span class="material-symbols-rounded external-icon">open_in_new</span>
                    </a>
                    <a href="http://localhost:8084/swagger/nestjs" target="_blank" rel="noopener noreferrer" class="sidenav-item">
                        <span class="material-symbols-rounded">description</span>
                        <span>Swagger NestJS</span>
                        <span class="material-symbols-rounded external-icon">open_in_new</span>
                    </a>
                    <a href="http://localhost:8084/swagger/dotnet" target="_blank" rel="noopener noreferrer" class="sidenav-item">
                        <span class="material-symbols-rounded">code</span>
                        <span>Swagger .NET</span>
                        <span class="material-symbols-rounded external-icon">open_in_new</span>
                    </a>
                </div>
            </div>
        </nav>

        <!-- Backdrop -->
        <div class="app-shell__backdrop" id="backdrop" onclick="closeDrawer()"></div>

        <!-- Main Content -->
        <main class="app-shell__content">
            <!-- Success Message -->
            <div th:if="${param.success}" class="snackbar success-message" id="successMessage">
                Operação realizada com sucesso!
            </div>
            <!-- Error Message -->
            <div th:if="${param.error}" class="snackbar error-message" id="errorMessage">
                Erro ao executar operação. Tente novamente.
            </div>

            <div th:replace="${view}"></div>
        </main>
    </div>

    <script th:inline="javascript">
        function toggleDrawer() {
            const drawer = document.getElementById('drawer');
            const backdrop = document.getElementById('backdrop');
            const isOpen = drawer.classList.contains('app-shell__drawer--open');

            if (isOpen) {
                closeDrawer();
            } else {
                drawer.classList.add('app-shell__drawer--open');
                backdrop.classList.add('visible');
            }
        }

        function closeDrawer() {
            const drawer = document.getElementById('drawer');
            const backdrop = document.getElementById('backdrop');
            drawer.classList.remove('app-shell__drawer--open');
            backdrop.classList.remove('visible');
        }

        // Auto-hide messages after 3 seconds
        setTimeout(function() {
            const successMsg = document.getElementById('successMessage');
            const errorMsg = document.getElementById('errorMessage');
            if (successMsg) successMsg.style.display = 'none';
            if (errorMsg) errorMsg.style.display = 'none';
        }, 3000);
    </script>
</body>
</html>
